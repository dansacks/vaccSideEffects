-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/sacks/Projects/VaccSideEffects/output/logs/treatment_effect
> s.log
  log type:  text
 opened on:  22 Jan 2026, 13:17:56
.     di "=== Running in batch mode: $scriptname ==="
=== Running in batch mode: treatment_effects ===
.     di "Log: output/logs/$scriptname.log"
Log: output/logs/treatment_effects.log
.     di ""

. }

. 
end of do-file

. 
. /*---------------------------------------------------------------------------
> ---
>     1. Define controls
> -----------------------------------------------------------------------------
> -*/
. 
. do "code/_set_controls.do"

. /*===========================================================================
> ===
>     Control Variables Definition
> 
>     Include this file in do-files that run regressions with control variables
> .
>     Sets globals: prior_beliefs, vacc_experience, demographics, controls
> =============================================================================
> =*/
. 
. * Prior beliefs from main survey
. global prior_beliefs "i.prior_self_placebo i.prior_self_vacc"

. 
. * Vaccine experiences from prescreen
. global vacc_experience "had_prior_covid_vacc had_prior_flu_vacc i.covid_vacc_
> reaction i.flu_vacc_reaction"

. 
. * Demographics from main survey
. global demographics "i.age i.gender i.education i.income i.race i.ethnicity i
> .polviews"

. 
. * All controls combined
. global controls "$prior_beliefs i.pre_vacc_intent $vacc_experience $demograph
> ics i.trust_govt cond_*"

. 
end of do-file

. 
. /*---------------------------------------------------------------------------
> ---
>     2. Load data and prepare variables
> -----------------------------------------------------------------------------
> -*/
. 
. use "derived/merged_all.dta", clear

. 
. * Create link_click if not already present (max of link1-4)
. capture confirm variable link_click

. if _rc {
.     egen link_click = rowmax(link1_clicked link2_clicked link3_clicked link4_
> clicked)
.     label var link_click "Any link clicked"
. }

. 
. * Convert -99 (prefer not to say) to missing for categorical variables
. foreach var in age gender education income race ethnicity {
  2.     replace `var' = . if `var' == -99
  3. }
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)

. 
. * Create vaccination outcome (got vaccine or already had it)
. gen vacc_post = got_flu_vacc == 1 | flu_why_already == 1 if ~missing(got_flu_
> vacc)
(536 missing values generated)

. 
. * Label treatment indicators
. label var arm_industry "Industry"

. label var arm_academic "Academic"

. label var arm_personal "Personal"

. 
. /*---------------------------------------------------------------------------
> ---
>     3. Generate treatment effects table
> -----------------------------------------------------------------------------
> -*/
. 
. regression_table post_trial delta main_maybe link_click vacc_post, ///
>     keyvars(arm_industry arm_academic arm_personal) ///
>     controls($controls) saving(output/tables/treatment_effects.tex)

=== Regression: post_trial ===

=== Regression: delta ===

=== Regression: main_maybe ===

=== Regression: link_click ===

=== Regression: vacc_post ===

Regression Table
-------------------------------------------------------------------------------
                      post_trial       delta  main_maybe  link_click   vacc_pos
> t
-------------------------------------------------------------------------------
Industry                  -7.971      -3.303      -0.000      -0.002      -0.01
> 4
                        ( 0.853)    ( 1.022)    ( 0.012)    ( 0.006)    ( 0.013
> )
Academic                  -4.392      -2.857       0.031      -0.003       0.02
> 1
                        ( 0.874)    ( 1.010)    ( 0.013)    ( 0.006)    ( 0.015
> )
Personal                  -4.728       0.387       0.024      -0.002       0.01
> 8
                        ( 0.878)    ( 1.018)    ( 0.013)    ( 0.006)    ( 0.014
> )
-------------------------------------------------------------------------------
Control mean              20.193      15.410       0.069       0.015       0.08
> 3
N                          3,516       3,516       3,516       3,516       2,99
> 2
-------------------------------------------------------------------------------
Saved: output/tables/treatment_effects.tex

. 
. capture log close
