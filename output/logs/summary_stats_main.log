
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      Stata 18.0
___/   /   /___/   /   /___/       SE—Standard Edition

 Statistics and Data Science       Copyright 1985-2023 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: Unlimited-user network, expiring 23 Oct 2026
Serial number: 401909300710
  Licensed to: Wisconsin School of Business
               University of Wisconsin - Madison

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. Maximum number of variables is set to 5,000 but can be increased;
          see help set_maxvar.

. do C:/Users/dwsacks/projects/vaccSideEffects/code/summary_stats_main.do 

. /*===========================================================================
> ===
>     Summary Statistics: Main Survey Data
> 
>     Input:  data/main_clean.dta
>     Output:
>       - output/tables/stats_main_continuous.csv
>       - output/tables/stats_main_categorical.csv
> 
>     Produces summary statistics for valid observations (final_sample == 1):
>     - Continuous variables: mean, SD, percentiles
>     - Categorical variables: frequency distribution
> 
>     Created by Dan + Claude Code
> =============================================================================
> =*/
. 
. clear all

. global scriptname "summary_stats_main"

. do "code/_config.do"

. /*===========================================================================
> ===
>     Project Configuration
> 
>     Set the project directory once here; all other scripts include this file.
> 
>     Usage: Include at the top of each do-file:
>         global scriptname "my_script"
>         do "code/_config.do"
> 
>     In batch mode (stata -e), logs to output/logs/{scriptname}.log
>     In interactive mode, no logging occurs.
> 
>     Created by Dan + Claude Code
> =============================================================================
> =*/
. 
. * Settings for both batch and interactive mode
. set more off

. set rmsg off

. 
. * Set project directory based on operating system
. * c(os) returns "Windows" on Windows, "Unix" or "MacOSX" on Mac
. local usr `c(username)'

. if "`c(os)'" == "Windows" {
.     global projdir "C:/Users/`usr'/Projects/VaccSideEffects"
. }

. else {
.     * macOS (Unix or MacOSX)
.     global projdir "/Users/`usr'/Projects/VaccSideEffects"
. }

. cd "$projdir"
C:\Users\dwsacks\Projects\VaccSideEffects

. 
. * Add local ado files to path (for plot_to_csv and other custom programs)
. adopath + "$projdir/code/include"
  [1]  (BASE)      "C:\Program Files\Stata18\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata18\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "C:\msys64\home\dwsacks\ado\personal/"
  [5]  (PLUS)      "C:\msys64\home\dwsacks\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "C:/Users/dwsacks/Projects/VaccSideEffects/code/include"

. adopath + "$projdir/code/ado"
  [1]  (BASE)      "C:\Program Files\Stata18\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata18\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "C:\msys64\home\dwsacks\ado\personal/"
  [5]  (PLUS)      "C:\msys64\home\dwsacks\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "C:/Users/dwsacks/Projects/VaccSideEffects/code/include"
  [8]              "C:/Users/dwsacks/Projects/VaccSideEffects/code/ado"

. 
. * Create output subdirectories if they don't exist
. capture mkdir "output"

. capture mkdir "output/logs"

. capture mkdir "output/tables"

. capture mkdir "output/docs"

. capture mkdir "output/figures"

. 
. /*---------------------------------------------------------------------------
> ---
>     Named Constants
> 
>     These replace magic numbers scattered throughout the codebase.
> -----------------------------------------------------------------------------
> -*/
. 
. * Attention check expected values (from survey design)
. global ATTN_CHECK_PRESCREEN = 1965

. global ATTN_CHECK_MAIN = 4419

. global ATTN_CHECK_FOLLOWUP = 1163

. 
. * Special code for unselected responses
. global UNSELECTED_VALUE  = -99

. 
. * Special code for "prefer not to say" responses (same as unselected)
. global PREF_NOT_SAY = -99

. 
. /*---------------------------------------------------------------------------
> ---
>     Conditional Logging
> -----------------------------------------------------------------------------
> -*/
. 
. * Only log in batch mode
. if "`c(mode)'" == "batch" & "$scriptname" != "" {
.     capture log close _all
.     log using "output/logs/$scriptname.log", replace text
-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\dwsacks\Projects\VaccSideEffects\output/logs/summary_stat
> s_main.log
  log type:  text
 opened on:  29 Jan 2026, 10:36:51
.     di "=== Running in batch mode: $scriptname ==="
=== Running in batch mode: summary_stats_main ===
.     di "Log: output/logs/$scriptname.log"
Log: output/logs/summary_stats_main.log
.     di ""

. }

. 
end of do-file

. 
. * Load cleaned data
. use "derived/main_clean.dta", clear

. 
. * Keep only valid observations
. keep if final_sample == 1
(120 observations deleted)

. count
  3,538

. local n_valid = r(N)

. 
. /*===========================================================================
> ===
>     EXPORT CONTINUOUS VARIABLE STATISTICS TO CSV
> =============================================================================
> =*/
. 
. file open contcsv using "output/tables/stats_main_continuous.csv", write repl
> ace

. file write contcsv "variable,n,mean,sd,min,p50,max" _n

. 
. * Continuous variables
. local cont_vars duration_sec post_trial posterior_novacc posterior_vacc delta
>  prior_diff

. 
. foreach var of local cont_vars {
  2.     summarize `var', detail
  3.     file write contcsv "`var'," (r(N)) "," (r(mean)) "," (r(sd)) "," (r(mi
> n)) "," (r(p50)) "," (r(max)) _n
  4. }

                  Survey duration (seconds)
-------------------------------------------------------------
      Percentiles      Smallest
 1%          121             49
 5%          161             72
10%          188             73       Obs               3,538
25%          239             82       Sum of wgt.       3,538

50%          317                      Mean           404.9681
                        Largest       Std. dev.       981.887
75%          447           3711
90%          651           3958       Variance       964102.1
95%          824           5507       Skewness       52.68835
99%         1442          56447       Kurtosis       3001.589

           Post-trial side effect estimate (0-100)
-------------------------------------------------------------
      Percentiles      Smallest
 1%            1              0
 5%            2              0
10%            2              0       Obs               3,538
25%            3              0       Sum of wgt.       3,538

50%            6                      Mean           16.04605
                        Largest       Std. dev.      19.03526
75%           23             97
90%           45             97       Variance       362.3411
95%           60             97       Skewness       1.709445
99%           78             98       Kurtosis       5.337583

      Posterior: SE probability without vaccine (0-100)
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs               3,538
25%            1              0       Sum of wgt.       3,538

50%            3                      Mean           12.53161
                        Largest       Std. dev.      20.16701
75%           13            100
90%           45            100       Variance       406.7084
95%           60            100       Skewness       2.218914
99%           90            100       Kurtosis       7.462345

       Posterior: SE probability with vaccine (0-100)
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            1              0
10%            2              0       Obs               3,538
25%            4              0       Sum of wgt.       3,538

50%           10                      Mean           25.71115
                        Largest       Std. dev.      28.07177
75%           45            100
90%           75            100       Variance       788.0244
95%           85            100       Skewness       1.099499
99%          100            100       Kurtosis       2.988539

            Posterior difference (vacc - novacc)
-------------------------------------------------------------
      Percentiles      Smallest
 1%          -47            -96
 5%          -10            -90
10%           -3            -80       Obs               3,538
25%            0            -80       Sum of wgt.       3,538

50%            3                      Mean           13.17955
                        Largest       Std. dev.        26.171
75%           20            100
90%           52            100       Variance       684.9215
95%           75            100       Skewness       1.137724
99%           95            100       Kurtosis        5.08893
variable prior_diff not found
r(111);

end of do-file
r(111);
